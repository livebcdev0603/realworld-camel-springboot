<routes xmlns="http://camel.apache.org/schema/spring">
  <route id="direct:returnError" routeConfigurationId="return-cleanup">
    <from uri="direct:returnError" />

    <setHeader name="__exceptionMessages"><groovy>
        import static com.github.jacekszymanski.realcamel.util.ExceptionUtil.*

        messages(exception(exchange))
    </groovy></setHeader>

    <!-- avoid validation error in jslt -->
    <setBody><constant>{}</constant></setBody>

    <to uri="jslt:classpath:jslt/error-resp.jslt" />

    <unmarshal>
      <json unmarshalType="com.github.jacekszymanski.realcamel.model.GenericErrorModel" />
    </unmarshal>

    <stop />

  </route>
</routes>
