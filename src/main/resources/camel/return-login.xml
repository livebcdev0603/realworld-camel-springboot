<routes xmlns="http://camel.apache.org/schema/spring">

  <route id="direct_returnLogin" routeConfigurationId="return-cleanup">
    <from uri="direct:returnLogin" />

    <setProperty name="__jwt_claims"><groovy><![CDATA[
      """{"sub": "${request.body.username}" }"""
    ]]></groovy></setProperty>

    <to uri="jwt:HS256:Create?privateKeyLocation=classpath:jwt.key.txt&amp;source=.__jwt_claims&amp;target=__jwt_token" />

    <marshal><json /></marshal>
    <to uri="jslt:jslt/login-resp.jslt" />

    <unmarshal>
      <json unmarshalType="com.github.jacekszymanski.realcamel.model.Login200Response"
            disableFeatures="FAIL_ON_UNKNOWN_PROPERTIES" />
    </unmarshal>

  </route>

</routes>
